**続き**


## TCP/IPにおける通信の流れ②
- データを目的地まで運ぶ
- ネットワーク層の役割
###### ルーター
- データを運ぶために使用する機器。
- データが最終目的地であるアプリケーションにたどり着くために、まずはそのアプリケーションが接続されている**ルーター**にたどり着く必要がある。
###### 流れ
- 電気信号となっているデータは最寄りのルーターへ移動する。
- 宛先のIPアドレスを利用し、次にどのルーターへ移動するか最寄りのルーターで確認する。
- ここから２通りの可能性あり。
  - ①最寄りのルーターと目的地のルーターが直接つながっている場合、「このルーターでおk！」となる。
  - ②直接つながっていない場合、「このルーターであれば、方面は合っているから、あっちで確認して」となる。
###### ルーティング（経路制御）
- 上記の流れのこと
- ネットワーク層におけるデータの転送は、各ルーターが把握しているところまでの道筋を教え合い、目的地へとパケットを転送するという仕組み

**以上で、TCP/IPにおける通信の流れ②は終了！**



## TCP/IPにおける通信の流れ③と各層の説明
- データを目的地内の指定アプリケーションまで届ける。
- 基本的には、ネットワークインターフェース層からアプリケーション層へと、1番とは逆の流れで届いたデータを受け渡していく。
- そして、各層でデータ内のヘッダを読み込み、必要な処理を施す。

### *ネットワークインターフェース層*
- イーサネットヘッダ内のMACアドレスから、接続されている各ホストが自分宛の通信かそうでないかを判断する。
- そして、自分宛の通信の場合、上位層のネットワーク層へと運ばれる。
- この段階で、イーサネットヘッダは取り除かれる。

### *ネットワーク層*
- IPヘッダを読み込む後、取り除かれる。
- その情報から、上位層プロトコルは何を使用しているのか(=TCP通信なのか、UDP通信なのか)を判断し、適切な場所にデータを受け渡せるよう準備する。
- 細切れになって送られてくるデータを繋ぎ合わせるのも、ネットワーク層の仕事

### *トランスポート層*
- TCPヘッダもいくはUDPヘッダを読み込み、取り除かれる。
- ポート番号からデータを適切なアプリケーションへとデータを受け渡す処理を行う。
- TCP通信のみ　：　上記にプラスして、「データが壊れていないか」「順番通りに受信できているか」などの確認を行い、問題なければデータの送信元に対して応答確認を返却する。データが正常に届くことを保証するTCP通信ならではの仕組み

### *アプリケーション層*
- ヘッダの処理はなし。
- 受け渡されたデータを元に、送信側ホストから要求された操作を実行することが主な役割

**以上で、TCP/IPにおける通信の流れ③は終了！**


概略ではあるが、インターネットの流れがこんな感じ。
